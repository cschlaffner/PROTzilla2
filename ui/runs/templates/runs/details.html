<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% load static %}
    <script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>
    {% include 'runs/change_method.html' %}
{#    <script src="{% static 'runs/change_method.html' %}"></script>#}
    <script src="{% static 'runs/form_buttons.js' %}"></script>
    <title>PROTzilla</title>
</head>
<body>
{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>
                {{ message | safe }}
            </p>
        {% endfor %}
    </div>
    <br>
{% endif %}

{{ run_name }}
<br>
<b>history</b>
<br>
<div id="displayed_history">
    {% for step in displayed_history %}
        <div id="{{ step.name }}">
            {{ step.name }}<br>
            {% for field in step.fields %}
                {{ field }}<br>
            {% endfor %}
            {% if step.plots %}
                <div id="plots">
                    {% for plot in step.plots %}
                        <div style="width:600;height:500">
                            {{ plot|safe }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        <br>
    {% endfor %}
</div>

<div id="current_step">
    <br>
    {{ location }}
    <br>
    <form action="{% url 'runs:calculate' run_name %}" id="calc_form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ method_dropdown }}
        <div id="method_parameters">
            {% include "runs/fields.html" with fields=fields %}
        </div>
        <input type="submit" id="calculate_parameters_submit" value="Calculate">
    </form>
    <form action="{% url 'runs:plot' run_name %}" id="plot_form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div id="plot_parameters">
            {% include "runs/fields.html" with fields=plot_fields %}
        </div>
        <input type="submit" id="plot_parameters_submit" value="Plot" {% if not show_next %} disabled {% endif %} >
    </form>

    {% if current_plots %}
        <div id="plots">
            {% for plot in current_plots %}
                <div style="width:600;height:500">
                    {{ plot|safe }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
<div id="nav_buttons">
    <form action="{% url 'runs:next' run_name %}" method="post">
        {% csrf_token %}
        <button {% if not show_next %} disabled {% endif %}>Next</button>
    </form>

    <form action="{% url 'runs:back' run_name %}" method="post">
        {% csrf_token %}
        <button {% if not show_back %} disabled {% endif %}>Back</button>
    </form>
</div>
</body>
</html>
